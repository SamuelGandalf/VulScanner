#!/usr/bin/python

import socket
#two functions 1.Return_Flag 2.Main

def Return_Flag(IP, Port):
	try:
		socket.setdefaulttimeout(2)
		sock = socket.socket()
		sock.connect((IP, Port))
		flag = sock.recv(1024) #to recieve 1024 bytes
		return flag
	except:
		print("[**] Port " + str(Port) + " not vulnerable!")

def main():
	#Port = 22 #port 22 by default is opened in metasploitable
	#IP = "172.28.11.12"
	IP = raw_input("[**] Enter IP of the Target: ")
	for  Port in range(1,100): #to scan for a wide range of ports not just a single port
		flag = Return_Flag(IP, Port)
		if flag:
			print("[*] " + IP + "/" + str(Port) + ": "  +  flag)
main()
